\documentclass{scrartcl}
\usepackage[latin1]{inputenc}
\usepackage{tabularx}
\usepackage[letterpaper,top=2cm,bottom=1.5cm,left=1.1cm,right=1.5cm]{geometry}
\usepackage{graphicx}

\begin{document}

\pagestyle{myheadings}
\thispagestyle{empty}

\fontfamily{cmss}\fontsize{10pt}{12pt}\selectfont

<?lsmb include letterhead.tex ?>


<?lsmb pagebreak 65 27 48 ?>
\end{tabularx}

  \rule{\textwidth}{2pt}
  
  \hfill
  \begin{tabularx}{7cm}{Xr@{\hspace{1cm}}r@{}}
  & \textbf{Subtotal} & \textbf{<?lsmb sumcarriedforward ?>} \\
  \end{tabularx}

\newpage

\markboth{<?lsmb company ?>\hfill <?lsmb ordnumber ?>}{<?lsmb company ?>\hfill <?lsmb ordnumber ?>}


\begin{tabularx}{\textwidth}{@{}rlXrlrrr@{}}
  \textbf{Item} & \textbf{Number} & \textbf{Description} & \textbf{Qt'y} &
  \textbf{Unit} & \textbf{Price} & \textbf{Disc \%} & \textbf{Amount} \\
  & carried forward from <?lsmb lastpage ?> & & & & & <?lsmb sumcarriedforward ?> \\
<?lsmb end pagebreak ?>


\vspace*{0.5cm}

\parbox[t]{.5\textwidth}{
\textbf{To}
\vspace{0.3cm}
  
<?lsmb name ?>

<?lsmb address1 ?>

<?lsmb address2 ?>

<?lsmb city ?>
<?lsmb if state ?>
\hspace{-0.1cm}, <?lsmb state ?>
<?lsmb end state ?>
<?lsmb zipcode ?>

<?lsmb country ?>

\vspace{0.3cm}

<?lsmb if contact ?>
<?lsmb contact ?>
\vspace{0.2cm}
<?lsmb end contact ?>

<?lsmb if customerphone ?>
Tel: <?lsmb customerphone ?>
<?lsmb end customerphone ?>

<?lsmb if customerfax ?>
Fax: <?lsmb customerfax ?>
<?lsmb end customerfax ?>

<?lsmb email ?>
}
\parbox[t]{.5\textwidth}{
\textbf{Ship To}
\vspace{0.3cm}

<?lsmb shiptoname ?>

<?lsmb shiptoaddress1 ?>

<?lsmb shiptoaddress2 ?>

<?lsmb shiptocity ?>
<?lsmb if shiptostate ?>
\hspace{-0.1cm}, <?lsmb shiptostate ?>
<?lsmb end shiptostate ?>
<?lsmb shiptozipcode ?>

<?lsmb shiptocountry ?>

\vspace{0.3cm}

<?lsmb if shiptocontact ?>
<?lsmb shiptocontact ?>
\vspace{0.2cm}
<?lsmb end shiptocontact ?>

<?lsmb if shiptophone ?>
Tel: <?lsmb shiptophone ?>
<?lsmb end shiptophone ?>

<?lsmb if shiptofax ?>
Fax: <?lsmb shiptofax ?>
<?lsmb end shiptofax ?>

<?lsmb shiptoemail ?>
}
\hfill

\vspace{1cm}

\textbf{S A L E S} \parbox{0.3cm}{\hfill} \textbf{O R D E R}
\hfill

\vspace{1cm}

\begin{tabularx}{\textwidth}{*{6}{|X}|} \hline
  \textbf{Order \#} & \textbf{Order Date} & \textbf{Required by} & \textbf{Salesperson} & \textbf{Shipping Point} & \textbf{Ship Via} \\ [0.5em]
  \hline
  <?lsmb ordnumber ?> & <?lsmb orddate ?> & <?lsmb reqdate ?> & <?lsmb employee ?> & <?lsmb shippingpoint ?> & <?lsmb shipvia ?> \\
  \hline
\end{tabularx}
  
\vspace{1cm}

\begin{tabularx}{\textwidth}{@{}rlXrlrrr@{}}
  \textbf{Item} & \textbf{Number} & \textbf{Description} & \textbf{Qt'y} &
  \textbf{Unit} & \textbf{Price} & \textbf{Disc \%} & \textbf{Amount} \\
<?lsmb foreach number ?>
  <?lsmb runningnumber ?> & <?lsmb number ?> & <?lsmb description ?> & <?lsmb qty ?> &
  <?lsmb unit ?> & <?lsmb sellprice ?> & <?lsmb discountrate ?> & <?lsmb linetotal ?> \\
<?lsmb end number ?>
\end{tabularx}


\parbox{\textwidth}{
\rule{\textwidth}{2pt}

\vspace{0.2cm}

\hfill
\begin{tabularx}{7cm}{Xr@{\hspace{1cm}}r@{}}
  & Subtotal & <?lsmb subtotal ?> \\
<?lsmb foreach tax ?>
  & <?lsmb taxdescription ?> on <?lsmb taxbase ?> & <?lsmb tax ?>\\
<?lsmb end tax ?>
  \hline
  & Total & <?lsmb ordtotal ?>\\
\end{tabularx}

\vspace{0.3cm}

<?lsmb text_amount ?> ***** <?lsmb decimal ?>/100
\hfill
All prices in \textbf{<?lsmb currency ?>}.

<?lsmb if terms ?>
Terms: <?lsmb terms ?> days
<?lsmb end terms ?>

\vspace{12pt}

<?lsmb notes ?>

}

\vfill

\centerline{\textbf{Thank You for your valued business!}}

\rule{\textwidth}{0.5pt}

\end{document}

