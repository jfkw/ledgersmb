\documentclass[10pt,letterpaper,oneside,onecolumn]{scrartcl}
\usepackage[frame]{xy}
\usepackage{tabularx}
\usepackage[latin1]{inputenc}
\usepackage{graphicx}
\setlength{\voffset}{0.5cm}
\setlength{\hoffset}{-1.9cm}
\setlength{\topmargin}{0cm}
\setlength{\headheight}{0.5cm}
\setlength{\headsep}{1cm}
\setlength{\topskip}{0pt}
\setlength{\oddsidemargin}{1.0cm}
\setlength{\evensidemargin}{1.0cm}
\setlength{\textwidth}{19.2cm}
\setlength{\textheight}{24.7cm}
\setlength{\footskip}{1cm}
\setlength{\parindent}{0pt}
\renewcommand{\baselinestretch}{1}

\begin{document}

\pagestyle{myheadings}
\thispagestyle{empty}

\fontfamily{cmss}\fontsize{10pt}{12pt}\selectfont

\newsavebox{\ftr}
\sbox{\ftr}{
  \parbox{\textwidth}{
  \tiny
  \rule[1.5em]{\textwidth}{0.5pt}
Payment due NET <?lsmb terms ?> Days from date of Invoice. Interest on overdue amounts will acrue at the rate of 12\% per annum starting from <?lsmb duedate ?> until paid in full. Items returned are subject to a 10\% restocking charge.
A return authorization must be obtained from <?lsmb company ?> before goods are returned. Returns must be shipped prepaid and properly insured.
<?lsmb company ?> will not be responsible for damages during transit.
  }
}

\vspace*{-1.3cm}

\parbox{\textwidth}{%
  \parbox[b]{.42\textwidth}{%
    <?lsmb company ?>
   
    <?lsmb address ?>
  }
  \parbox[b]{.2\textwidth}{
    \includegraphics[scale=0.3]{ledger-smb}
  }\hfill
  \begin{tabular}[b]{rr@{}}
  Telephone & <?lsmb tel ?>\\
  Facsimile & <?lsmb fax ?>
  \end{tabular}

  \rule[1.5em]{\textwidth}{0.5pt}
}


<?lsmb pagebreak 65 27 37 ?>
\end{tabularx}

  \rule{\textwidth}{2pt}
  
  \hfill
  \begin{tabularx}{7cm}{Xr@{}}
  \textbf{Subtotal} & \textbf{<?lsmb sumcarriedforward ?>} \\
  \end{tabularx}

\newpage

\markboth{<?lsmb company ?>\hfill <?lsmb invnumber ?>}{<?lsmb company ?>\hfill <?lsmb invnumber ?>}

\vspace*{-12pt}

\begin{tabularx}{\textwidth}{@{}rlXlrlrrr@{}}
  \textbf{Pos} & \textbf{Number} & \textbf{Description} & & \textbf{Qt'y} &
    \textbf{Unit} & \textbf{Price} & \textbf{Disc \%} & \textbf{Amount} \\ [0.5em]
  & carried forward from page <?lsmb lastpage ?> & & & & & & <?lsmb sumcarriedforward ?> \\ [0.5em]
<?lsmb end pagebreak ?>


\vspace*{0.5cm}

\parbox[t]{1cm}{\hfill}
\parbox[t]{.6\textwidth}{
\textbf{To}
\vspace{0.7cm}

<?lsmb name ?>

<?lsmb address1 ?>

<?lsmb address2 ?>

<?lsmb city ?> <?lsmb state ?> <?lsmb zipcode ?>

<?lsmb country ?>

\vspace{0.3cm}

<?lsmb if contact ?>
<?lsmb contact ?>
\vspace{0.2cm}
<?lsmb end contact ?>

<?lsmb if customerphone ?>
Tel: <?lsmb customerphone ?>
<?lsmb end customerphone ?>

<?lsmb if customerfax ?>
Fax: <?lsmb customerfax ?>
<?lsmb end customerfax ?>

<?lsmb email ?>
}
\parbox[t]{.4\textwidth}{
\textbf{Ship To}
\vspace{0.7cm}

<?lsmb shiptoname ?>

<?lsmb shiptoaddress1 ?>

<?lsmb shiptoaddress2 ?>

<?lsmb shiptocity ?> <?lsmb shiptostate ?> <?lsmb shiptozipcode ?>

<?lsmb shiptocountry ?>

\vspace{0.3cm}

<?lsmb if shiptocontact ?>
<?lsmb shiptocontact ?>
\vspace{0.2cm}
<?lsmb end shiptocontact ?>

<?lsmb if shiptophone ?>
Tel: <?lsmb shiptophone ?>
<?lsmb end shiptophone ?>

<?lsmb if shiptofax ?>
Fax: <?lsmb shiptofax ?>
<?lsmb end shiptofax ?>

<?lsmb shiptoemail ?>
}
\hfill

\vspace{1cm}

\textbf{I N V O I C E}
\hfill

\vspace{1cm}

\begin{tabularx}{\textwidth}{*{7}{|X}|} \hline
  \textbf{Invoice \#} & \textbf{Date} & \textbf{Due} & \textbf{Order \#}
  & \textbf{Salesperson} & \textbf{Shipping Point} &
  \textbf{Ship via} \\ [0.5em]
  \hline
  <?lsmb invnumber ?> & <?lsmb invdate ?> & <?lsmb duedate ?> & <?lsmb ordnumber ?> & <?lsmb employee ?>
  & <?lsmb shippingpoint ?> & <?lsmb shipvia ?> \\
  \hline
\end{tabularx}

\vspace{1cm}

\begin{tabularx}{\textwidth}{@{}rlXlrlrrr@{}}
  \textbf{Pos} & \textbf{Number} & \textbf{Description} & & \textbf{Qt'y} &
    \textbf{Unit} & \textbf{Price} & \textbf{Disc \%} & \textbf{Amount} \\ [0.5em]
<?lsmb foreach number ?>
  <?lsmb runningnumber ?> & <?lsmb number ?> & <?lsmb description ?> & <?lsmb deliverydate ?> &
  <?lsmb qty ?> & <?lsmb unit ?> & <?lsmb sellprice ?> & <?lsmb discountrate ?> & <?lsmb linetotal ?> \\
<?lsmb end number ?>
\end{tabularx}


\parbox{\textwidth}{
\rule{\textwidth}{2pt}

\vspace{0.2cm}

\hfill
\begin{tabularx}{7cm}{Xr@{}}
  Subtotal & <?lsmb subtotal ?> \\
<?lsmb foreach tax ?>
  <?lsmb taxdescription ?> on <?lsmb taxbase ?> & <?lsmb tax ?> \\
<?lsmb end tax ?>
<?lsmb if paid ?>
  Paid & - <?lsmb paid ?> \\
<?lsmb end paid ?>
  \hline
<?lsmb if total ?>
  Balance Due & <?lsmb total ?>
<?lsmb end total ?>
\end{tabularx}

\vspace{0.3cm}

<?lsmb text_amount ?> ***** <?lsmb decimal ?>/100
\hfill
All prices in \textbf{<?lsmb currency ?>}.

\vspace{12pt}

<?lsmb if notes ?>
  <?lsmb notes ?>
<?lsmb end if ?>

}

\vfill

<?lsmb if paid ?>
\begin{tabularx}{10cm}{@{}lXlr@{}}
  \textbf{Payments} & & & \\
  \hline
  \textbf{Date} & & \textbf{Source} & \textbf{Amount} \\
<?lsmb end paid ?>
<?lsmb foreach payment ?>
  <?lsmb paymentdate ?> & <?lsmb paymentaccount ?> & <?lsmb paymentsource ?> & <?lsmb payment ?> \\
<?lsmb end payment ?>
<?lsmb if paid ?>
\end{tabularx}
<?lsmb end paid ?>

\vspace{1cm}

\centerline{\textbf{Thank You for your valued business!}}

\rule{\textwidth}{0.5pt}

\usebox{\ftr}

\end{document}

